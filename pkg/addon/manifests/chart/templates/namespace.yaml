# namespace is klusterlet-{clusterName} in hosted mode or custom namespace in default mode.
# We need to set deletion-orphan annotation to prevent accidental deletion when shared by multiple addons.
{{- if ne .Release.Namespace "open-cluster-management-agent-addon" }}
apiVersion: v1
kind: Namespace
metadata:
  name: {{ .Release.Namespace }}
  labels:
  {{- if eq .Values.installMode "Hosted" }}
    addon.open-cluster-management.io/hosted-manifest-location: hosting
  {{- end }}
    addon.open-cluster-management.io/namespace: "true"
  annotations:
    # Prevent namespace deletion when addon is removed
    # Hosted mode: shared with other addons and klusterlet components
    # Default mode with custom namespace: may be shared via AddOnDeploymentConfig
    "addon.open-cluster-management.io/deletion-orphan": ""
{{- end }}
